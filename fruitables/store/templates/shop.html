{% extends 'base.html' %}
{% load static %}

{% block title %} Store {% endblock title %}
{% block keywords %} Shop, Categories, Products {% endblock keywords%}
{% block description %} Shop page with categories and products {% endblock description%}

{% block content %}
    {% include 'partials/_single-page-header.html' %}
    <!-- Fruits Shop Start-->
    <div class="container-fluid fruite py-5">
        <div class="container py-5">
            <h1 class="mb-4">Fresh Products shop</h1>
            <div class="row g-4">
                <div class="col-lg-12">
                    <div class="row g-4">
                        <div class="col-xl-3">
                            <form action="{% url 'shop_view' %}" method="GET" id="search-form">
                                <div class="input-group w-100 mx-auto d-flex">
                                    {% if search_query %}
                                        <input type="search" name="q" class="form-control p-3" placeholder="Search products" aria-describedby="search-icon-1" value="{{ search_query }}">
                                    {% else %}
                                        <input type="search" name="q" class="form-control p-3" placeholder="Search products" aria-describedby="search-icon-1">
                                    {% endif %}
                                    <span style="cursor:pointer;" id="search-icon-1" class="input-group-text p-3"><i class="fa fa-search"></i></span>
                                </div>
                            </form>
                        </div>
                        <div class="col-6"></div>
                        <div class="col-xl-3">
                            <div class="bg-light ps-3 py-3 rounded d-flex justify-content-between mb-4">
                                <form action="." method="GET" name="products-sorting" id="fruitform">
                                    <label for="fruits">Default Sorting:</label>
                                    <select style="cursor: pointer;" id="fruits" name="productlist" class="border-0 form-select-sm bg-light me-3" onchange="this.form.submit()">
                                        <option value="default" {% if sorting_option == "default" %}selected{% endif %}>Default</option>
                                        <option value="ascending" {% if sorting_option == "ascending" %}selected{% endif %}>Price Ascending</option>
                                        <option value="descending" {% if sorting_option == "descending" %}selected{% endif %}>Price Descending</option>
                                    </select>
                                
                                    <input type="hidden" name="rangeInput" value="{{ range_input }}">
                                    <input type="hidden" name="tags" value="{{ selected_tag }}">
                                </form>                                                               
                            </div>
                        </div>
                    </div>
                    <div class="row g-4">
                        <div class="col-lg-3">
                            <div class="row g-4">
                                <div class="col-lg-12">

                                    <!-- Categories Listing -->
                                    <div class="mb-3">
                                        {% include 'additional/categories.html' %}
                                    </div>

                                </div>

                                <!-- Price, Additional Filters -->
                                <form method="GET" action=".">
                                    <input type="hidden" name="productlist" value="{{ sorting_option }}">
                                    {% include 'additional/price-filter.html' %}
                                    {% include 'additional/additional-filter.html' %}
                                
                                    <div class="d-flex justify-content-center my-4">
                                        <button type="submit" class="btn border border-secondary px-4 py-3 rounded-pill text-primary w-100">
                                            Apply Filters
                                        </button>
                                    </div>
                                    <div class="d-flex justify-content-center my-4">
                                        <button type="button" id="refresh-filters" class="btn border border-secondary px-4 py-3 rounded-pill text-primary w-100">
                                            Refresh Filters
                                        </button>
                                    </div>
                                </form>
                                

                                <div class="col-lg-12">

                                    <!-- Featured Products -->
                                    {% include 'additional/featured-products.html' %}
                                    <div class="d-flex justify-content-center my-4">
                                        <a href="#" class="btn border border-secondary px-4 py-3 rounded-pill text-primary w-100">Vew More</a>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-lg-9">
                            <div class="row g-4 justify-content-center">

                                {% include 'product_related/product-cards.html' %}   

                                {% include 'additional/page-paginator.html' %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Fruits Shop End-->

    {% block javascripts %}
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                document.getElementById('search-icon-1').addEventListener('click', function() {
                    document.getElementById('search-form').submit(); 
                });
                document.getElementById('refresh-filters').addEventListener('click', function() {
                    const form = this.closest('form');
                    Array.from(form.elements).forEach(element => {
                        if (element.type === 'checkbox' || element.type === 'radio') {
                            element.checked = false;
                        } else {
                            element.value = 50;
                        }
                    });
                    form.submit();
                    const paginator = document.getElementById('paginator');
                    if (paginator) {
                        paginator.href = paginator.dataset.defaultHref;
                    }
                });
            });
            
        </script>
    {% endblock javascripts %}


{% endblock content %}
